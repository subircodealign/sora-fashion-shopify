{% if customer %}
<div class="max-w-5xl mx-auto bg-white rounded-lg p-10 min-h-[60rem]">

  <!-- Header Background with Image -->
  <div class="h-24 rounded-t-lg mb-8 overflow-hidden relative">

    {% if section.settings.img != blank %}

        <img src="{{ section.settings.img | image_url: width: 1200 }}" alt="{{ section.settings.label | escape }}" width="1200" height="150"
        class="w-full object-cover " loading="lazy">

        {% else %}
    <img
      id="header-bg-image"
      src="https://placehold.co/1200x150"
      alt="Header Background"
      width="1200"
      height="150"
      class="w-full h-full object-cover"
    />
  {% endif %}
  </div>

  <div class="flex items-start gap-8">
    <!-- Profile Pic with Edit Icon -->
    <div class="relative w-24 h-24 rounded-full bg-gray-300 overflow-hidden flex-shrink-0">
      <img
        id="profile-pic"
        src="{{ customer.metafields.custom.profile_image | default: 'https://placehold.co/100x100' }}"
        alt="Profile"
        width="100"
        height="100"
        class="w-full h-full object-cover"
      />
      <label
        for="image-upload"
        id="edit-image-icon"
        class="absolute bottom-1/2 right-1/2 w-6 h-6 bg-white border rounded-full text-xs flex items-center justify-center cursor-pointer hover:bg-gray-100"
        title="Edit Profile Image"
      >✏️</label>
      <input id="image-upload" type="file" accept="image/*" class="hidden" />
    </div>

    <!-- Profile Info (Name, Email, Edit Btn) -->
    <div class="flex-1">
      <div class="flex items-center gap-4 mb-2">
        <h2 id="profile-name" class="text-2xl font-semibold text-zinc-800">
          {{ customer.first_name }} {{ customer.last_name }}
        </h2>
        <button id="edit-name" class="text-gray-600 text-sm cursor-pointer" title="Edit Name">✏️</button>
      </div>
      <div class="flex items-center gap-4 mb-6 opacity-70">
        <p id="profile-email" class="text-base text-zinc-800">{{ customer.email }}</p>
      </div>
    </div>

    <div>
      <button
        id="edit-btn"
        class="px-6 py-2 bg-slate-500 text-white rounded-lg text-sm"
      >
        Edit
      </button>
    </div>
  </div>

  <!-- Profile Form -->
  <form id="profile-form" class="mt-10 max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Full Name -->
    <div>
      <label for="full_name" class="block mb-1 font-medium text-zinc-800">Full Name</label>
      <input
        type="text"
        id="full_name"
        name="full_name"
        value="{{ customer.metafields.custom.full_name }}"
        placeholder="Your Full Name"
        class="w-full h-12 bg-stone-50 rounded-lg px-4 text-zinc-800 opacity-40 disabled:opacity-40"
        disabled
      />
    </div>

    <!-- Nick Name -->
    <div>
      <label for="nick_name" class="block mb-1 font-medium text-zinc-800">Nick Name</label>
      <input
        type="text"
        id="nick_name"
        name="nick_name"
        value="{{ customer.metafields.custom.nick_name }}"
        placeholder="Your Nick Name"
        class="w-full h-12 bg-stone-50 rounded-lg px-4 text-zinc-800 opacity-40 disabled:opacity-40"
        disabled
      />
    </div>

    <!-- Gender -->
    <div>
      <label for="gender" class="block mb-1 font-medium text-zinc-800">Gender</label>
      <select
        id="gender"
        name="gender"
        class="w-full h-12 bg-stone-50 rounded-lg px-4 text-zinc-800 opacity-40 disabled:opacity-40"
        disabled
      >
        <option value="">Select Gender</option>
        <option value="Male" {% if customer.metafields.custom.gender == "Male" %}selected{% endif %}>Male</option>
        <option value="Female" {% if customer.metafields.custom.gender == "Female" %}selected{% endif %}>Female</option>
        <option value="Other" {% if customer.metafields.custom.gender == "Other" %}selected{% endif %}>Other</option>
      </select>
    </div>

    <!-- Country -->
    <div>
      <label for="country" class="block mb-1 font-medium text-zinc-800">Country</label>
      <select
        id="country"
        name="country"
        class="w-full h-12 bg-stone-50 rounded-lg px-4 text-zinc-800 opacity-40 disabled:opacity-40"
        disabled
      >
        <option value="">Select Country</option>
        <option value="Bangladesh" {% if customer.metafields.custom.country == "Bangladesh" %}selected{% endif %}>Bangladesh</option>
        <option value="USA" {% if customer.metafields.custom.country == "USA" %}selected{% endif %}>USA</option>
        <option value="UK" {% if customer.metafields.custom.country == "UK" %}selected{% endif %}>UK</option>
      </select>
    </div>

    <!-- Language -->
    <div>
      <label for="language" class="block mb-1 font-medium text-zinc-800">Language</label>
      <select
        id="language"
        name="language"
        class="w-full h-12 bg-stone-50 rounded-lg px-4 text-zinc-800 opacity-40 disabled:opacity-40"
        disabled
      >
        <option value="">Select Language</option>
        <option value="English" {% if customer.metafields.custom.language == "English" %}selected{% endif %}>English</option>
        <option value="Bengali" {% if customer.metafields.custom.language == "Bengali" %}selected{% endif %}>Bengali</option>
        <option value="Spanish" {% if customer.metafields.custom.language == "Spanish" %}selected{% endif %}>Spanish</option>
      </select>
    </div>

    <!-- Time Zone -->
    <div>
      <label for="timezone" class="block mb-1 font-medium text-zinc-800">Time Zone</label>
      <select
        id="timezone"
        name="timezone"
        class="w-full h-12 bg-stone-50 rounded-lg px-4 text-zinc-800 opacity-40 disabled:opacity-40"
        disabled
      >
        <option value="">Select Time Zone</option>
        <option value="GMT +6" {% if customer.metafields.custom.timezone == "GMT +6" %}selected{% endif %}>GMT +6</option>
        <option value="GMT +5" {% if customer.metafields.custom.timezone == "GMT +5" %}selected{% endif %}>GMT +5</option>
        <option value="GMT +7" {% if customer.metafields.custom.timezone == "GMT +7" %}selected{% endif %}>GMT +7</option>
      </select>
    </div>
  </form>

  <!-- My Email Address Section -->
  <div class="mt-12 max-w-5xl">
    <h3 class="text-lg font-semibold text-zinc-800 mb-4">My email Address</h3>
    <div class="flex items-start gap-4 mb-6">
      <div class="w-10 h-10 bg-slate-500 opacity-10 rounded-full flex items-center justify-center text-white">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 13.5l8-6V6l-8 6-8-6v1.5l8 6z" />
        </svg>
      </div>
      <div>
        <p class="text-base text-zinc-800" id="main-email-display">{{ customer.email }}</p>
        <p class="text-sm text-zinc-800 opacity-50">1 month ago</p>
      </div>
    </div>
    <button
      id="toggleEmailField"
      class="text-slate-500 bg-slate-500 bg-opacity-10 px-5 py-2 rounded-lg"
    >
      + Add Email Address
    </button>
    <div id="emailInputWrapper" class="hidden mt-4 flex items-center gap-4">
      <input
        type="email"
        id="new-email"
        placeholder="Enter new email"
        class="w-60 h-12 bg-stone-50 rounded-lg px-4 text-zinc-800"
      />
      <button id="save-email-btn" class="bg-slate-500 text-white px-6 py-2 rounded-lg">
        Save
      </button>
    </div>
  </div>

  <!-- Toast is common in theme.liquid, so no local toast div here -->

</div>
<script src="{{ 'account-update.js' | asset_url }}" defer></script>

{% else %}
<div class="text-center py-20">
  Please <a href="/account/login" class="text-blue-600 underline">login</a> to view your profile.
</div>
{% endif %}

